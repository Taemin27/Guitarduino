// 'Effects', 160x80px
const unsigned char effectsHome [] PROGMEM = {
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0xf8, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x1f, 0xfc, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x7f, 0xfc, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0xff, 0xfc, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0xff, 0xfc, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x1f, 0xff, 0xfc, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x7f, 0xff, 0xfc, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0xff, 0xf8, 0x7c, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x07, 0xff, 0xc0, 0x7c, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1f, 
	0xff, 0x00, 0x7c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x3f, 0xfc, 0x00, 0x7c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3f, 0xf0, 0x00, 0x7c, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3f, 0xc0, 0x00, 0x7c, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3e, 
	0x00, 0x00, 0x7c, 0x3f, 0xff, 0x81, 0xf1, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x3e, 0x00, 0x00, 0x7c, 0x3f, 0xff, 0x83, 0xf3, 0xf0, 0x00, 0x00, 0x00, 0x06, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3e, 0x00, 0x00, 0x7c, 0x3f, 0xff, 0x87, 0x87, 0x80, 
	0x00, 0x00, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3e, 0x00, 0x00, 0x7c, 0x38, 
	0x00, 0x07, 0x07, 0x00, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3e, 
	0x00, 0x00, 0x7c, 0x38, 0x00, 0x07, 0x07, 0x00, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x3e, 0x00, 0x00, 0x7c, 0x38, 0x00, 0x07, 0x07, 0x00, 0x00, 0x00, 0x00, 0x0e, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3e, 0x00, 0x00, 0x7c, 0x38, 0x00, 0x1f, 0xdf, 0xc0, 
	0xfc, 0x00, 0xfc, 0x3f, 0x83, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3e, 0x00, 0x00, 0x7c, 0x38, 
	0x00, 0x1f, 0xdf, 0xc1, 0xff, 0x03, 0xfe, 0x3f, 0x8f, 0xfc, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3e, 
	0x00, 0x00, 0x7c, 0x3f, 0xff, 0x07, 0x07, 0x03, 0x87, 0x87, 0x87, 0x0e, 0x1e, 0x1e, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x3e, 0x00, 0x00, 0x7c, 0x3f, 0xff, 0x07, 0x07, 0x07, 0x03, 0x87, 0x07, 0x8e, 
	0x1c, 0x0e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3e, 0x00, 0x00, 0x7c, 0x3f, 0xff, 0x07, 0x07, 0x0e, 
	0x01, 0xce, 0x03, 0x8e, 0x1c, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3e, 0x00, 0x00, 0x7c, 0x38, 
	0x00, 0x07, 0x07, 0x0e, 0x01, 0xce, 0x00, 0x0e, 0x1f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3e, 
	0x00, 0x00, 0x7c, 0x38, 0x00, 0x07, 0x07, 0x0f, 0xff, 0xce, 0x00, 0x0e, 0x0f, 0xe0, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x3e, 0x00, 0x00, 0x7c, 0x38, 0x00, 0x07, 0x07, 0x0f, 0xff, 0xce, 0x00, 0x0e, 
	0x03, 0xfc, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3e, 0x00, 0x00, 0x7c, 0x38, 0x00, 0x07, 0x07, 0x0e, 
	0x00, 0x0e, 0x00, 0x0e, 0x00, 0x7e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3e, 0x00, 0x00, 0x7c, 0x38, 
	0x00, 0x07, 0x07, 0x0e, 0x00, 0x0e, 0x03, 0x8e, 0x00, 0x0f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3e, 
	0x00, 0x00, 0x7c, 0x38, 0x00, 0x07, 0x07, 0x0f, 0x01, 0xce, 0x03, 0x8e, 0x1c, 0x07, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x3e, 0x00, 0x00, 0x7c, 0x38, 0x00, 0x07, 0x07, 0x07, 0x03, 0x87, 0x07, 0x0e, 
	0x1e, 0x07, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3e, 0x00, 0x00, 0x7c, 0x3f, 0xff, 0x87, 0x07, 0x07, 
	0x87, 0x87, 0x8f, 0x0e, 0x0f, 0x0f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3e, 0x00, 0x00, 0x7c, 0x3f, 
	0xff, 0x87, 0x07, 0x03, 0xff, 0x03, 0xfe, 0x0f, 0x87, 0xfe, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3e, 
	0x00, 0x07, 0xfc, 0x3f, 0xff, 0x87, 0x07, 0x00, 0xfc, 0x00, 0xf8, 0x07, 0x83, 0xf8, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x3e, 0x00, 0x1f, 0xfc, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x3e, 0x00, 0x7f, 0xfc, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0xfe, 0x00, 0xff, 0xfc, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0f, 0xfe, 
	0x00, 0xff, 0xfc, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x3f, 0xfe, 0x01, 0xff, 0xfc, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7f, 0xfe, 0x01, 0xff, 0xf8, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7f, 0xfe, 0x01, 0xff, 0xf8, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xfe, 
	0x00, 0xff, 0xf0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0xff, 0xfc, 0x00, 0xff, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xfc, 0x00, 0x7f, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7f, 0xf8, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7f, 0xe0, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x3f, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

/*
Dynamic
  Compressor
  EQ
  Boost

Pitch
  Pitch Shifter
  Octaver

Drive
  Overdrive
  Distortion
  Fuzz

Modulation
  Chorus
  Phaser
  Flanger

Time-Based
  Delay
  Reverb
*/




int ef_presetNum = 1;
int ef_cursorLoc = 0;
int ef_maxCursorLoc = 0;
bool ef_valueSelected = false;


// Dynamic effects variables




// Drive effects variables
bool ef_drive_on = false;
int ef_drive_mode = 0;    // 0: Overdrive, 1: Distortion, 2: Fuzz
int ef_od_drive = 5;
int ef_od_level = 5;
int ef_od_tone = 5;
int ef_ds_drive = 5;
int ef_ds_level = 5;
int ef_ds_tone = 5;
int ef_fz_drive = 5;
int ef_fz_level = 5;
int ef_fz_tone = 5;

#define EF_OD_LENGTH  4097
float ef_od_shape[EF_OD_LENGTH];

// Modulation effects variables
bool ef_chorus_on = false;
int ef_chorus_depth = 5;
int ef_chorus_rate = 5;
int ef_chorus_mix = 10;


// Time-Based effects variables
bool ef_reverb_on = false;
int ef_reverb_roomSize = 5;
int ef_reverb_damping = 7;
int ef_reverb_wetDry = 3;

bool ef_delay_on = false;
float ef_delay_time = 0.15;
int ef_delay_feedback = 5;
int ef_delay_level = 7;

enum Ef_pages {
  home,
  typeMenu,
    dynamic,
      compressorSettings,
    driveSettings,
    modulation,
      chorusSettings,
    timeBased,
      delaySettings,
      reverbSettings
    
};


Ef_pages ef_currentPage = home;


void effects_setup() {
  display.fillScreen(BLACK);
  display.drawBitmap(0, 0, effectsHome, 160, 80, WHITE);
  drawArrows();
  display.display();
}

void effects_loop() {
  // Button pressed
  bounce.update();
  if(bounce.changed() && bounce.read() == LOW) {
    switch(ef_currentPage) {
      case home:
        pageSelected = true;
        ef_currentPage = typeMenu;
        ef_drawTypeMenu();
        display.display();
        break;

      case typeMenu:
        switch(ef_cursorLoc) {
          case 0:
            pageSelected = false;
            ef_currentPage = home;
            effects_setup();
            break;
          case 2:
            ef_currentPage = dynamic;
            ef_cursorLoc = 0;
            ef_drawDynamic();
            display.display();
            break;
          case 4:
            ef_currentPage = driveSettings;
            ef_cursorLoc = 0;
            ef_drawDrive();
            display.display();
            break;
          case 5:
            ef_currentPage = modulation;
            ef_cursorLoc = 0;
            ef_drawModulation();
            display.display();
            break;
          case 6:
            ef_currentPage = timeBased;
            ef_cursorLoc = 0;
            ef_drawTimeBased();
            display.display();
            break;
        }
        break;

      // Menus under dymanic
      case dynamic:
        switch(ef_cursorLoc) {
          case 0:
            ef_currentPage = typeMenu;
            ef_cursorLoc = 2;
            ef_drawTypeMenu();
            display.display();
            break;
          case 1:
            ef_currentPage = compressorSettings;
            ef_cursorLoc = 0;
            ef_drawCompressor();
            display.display();
            break;
        }
        break;

        case compressorSettings:
          switch(ef_cursorLoc) {
            case 0:
              ef_currentPage = dynamic;
              ef_cursorLoc = 1;
              ef_drawDynamic();
              display.display();
              break;
            case 1:
              ef_compressor_on = !ef_compressor_on;
              ef_drawCompressor();
              display.display();
              break;
            default:
              ef_valueSelected = !ef_valueSelected;
              ef_drawCompressor();
              display.display();
              break;
          }
          break;

      // Drive menu
      case driveSettings:
        switch(ef_cursorLoc) {
          case 0:
            ef_currentPage = typeMenu;
            ef_cursorLoc = 4;
            ef_drawTypeMenu();
            display.display();
            break;
          case 1:
            ef_drive_on = !ef_drive_on;
            ef_drawDrive();
            display.display();
            break;
          default:
            ef_valueSelected = !ef_valueSelected;
            ef_drawDrive();
            display.display();
            break;
        }
        break;

      // Menus under modulation
      case modulation:
        switch(ef_cursorLoc) {
          case 0:
            ef_currentPage = typeMenu;
            ef_cursorLoc = 0;
            ef_drawTypeMenu();
            display.display();
            break;
          case 1:
            ef_currentPage = chorusSettings;
            ef_cursorLoc = 0;
            ef_drawChorus();
            display.display();
            break;
        }
        break;
        case chorusSettings:
          switch(ef_cursorLoc) {
            case 0:
              ef_currentPage = modulation;
              ef_cursorLoc = 1;
              ef_drawModulation();
              display.display();
              break;
            case 1:
              ef_chorus_on = !ef_chorus_on;
              ef_drawChorus();
              display.display();
              break;
            default:
              ef_valueSelected = !ef_valueSelected;
              ef_drawChorus();
              display.display();
              break;
          }
          break;
    
      // Menus under time-based
      case timeBased:
        switch(ef_cursorLoc) {
          case 0:
            ef_currentPage = typeMenu;
            ef_cursorLoc = 6;
            ef_drawTypeMenu();
            display.display();
            break;
          case 1:
            ef_currentPage = delaySettings;
            ef_cursorLoc = 0;
            ef_drawDelay();
            display.display();
            break;
          case 2:
            ef_currentPage = reverbSettings;
            ef_cursorLoc = 0;
            ef_drawReverb();
            display.display();
            break;
        }
        break;

        case delaySettings:
          switch(ef_cursorLoc) {
            case 0:
              ef_currentPage = timeBased;
              ef_cursorLoc = 1;
              ef_drawTimeBased();
              display.display();
              break;
            case 1:
              ef_delay_on = !ef_delay_on;
              ef_drawDelay();
              display.display();
              break;
            default:
              ef_valueSelected = !ef_valueSelected;
              ef_drawDelay();
              display.display();
              break;
          }
          break;

        case reverbSettings:
          switch(ef_cursorLoc) {
            case 0:
              ef_currentPage = timeBased;
              ef_cursorLoc = 2;
              ef_drawTimeBased();
              display.display();
              break;
            case 1:
              ef_reverb_on = !ef_reverb_on;
              ef_drawReverb();
              display.display();
              break;
            default:
              ef_valueSelected = !ef_valueSelected;
              ef_drawReverb();
              display.display();
              break;
          }
          break;
    }
  }

  // Encoder turned
  if (pageSelected) {
    int encoder = readEncoder();

    if(encoder == 0) {

    }
    else {
      // Right
      if (encoder == 1) {
        // Changing effect values
        if (ef_valueSelected) {
          switch(ef_currentPage) {

            case compressorSettings:
              if(ef_cursorLoc == 2) {
                if(ef_compressor_level < 10) {
                  ef_compressor_level ++;
                }
              }
              else if(ef_cursorLoc == 3) {
                if(ef_compressor_threshold < 10) {
                  ef_compressor_threshold ++;
                }
              }
              else if(ef_cursorLoc == 4) {
                if(ef_compressor_release < 10) {
                  ef_compressor_release ++;
                }
              }
              break;

            case driveSettings:
              // OD
              if(ef_drive_mode == 0) {
                if (ef_cursorLoc == 2) {
                  ef_drive_mode = 1;
                }
                else if (ef_cursorLoc == 3) {
                  if(ef_od_drive < 10) {
                    ef_od_drive ++;
                  }
                }
                else if (ef_cursorLoc == 4) {
                  if(ef_od_level < 10) {
                    ef_od_level ++;
                  }
                }
                else if (ef_cursorLoc == 5) {
                  if(ef_od_tone < 10) {
                    ef_od_tone ++;
                  }
                }
              }

              // DS
              else if (ef_drive_mode == 1) {
                if (ef_cursorLoc == 2) {
                  ef_drive_mode = 2;
                }
                else if (ef_cursorLoc == 3) {
                  if(ef_ds_drive < 10) {
                    ef_ds_drive ++;
                  }
                }
                else if (ef_cursorLoc == 4) {
                  if(ef_ds_level < 10) {
                    ef_ds_level ++;
                  }
                }
                else if (ef_cursorLoc == 5) {
                  if(ef_ds_tone < 10) {
                    ef_ds_tone ++;
                  }
                }
              }

              // FZ
              else if (ef_drive_mode == 2) {
                if (ef_cursorLoc == 3) {
                  if(ef_fz_drive < 10) {
                    ef_fz_drive ++;
                  }
                }
                else if (ef_cursorLoc == 4) {
                  if(ef_fz_level < 10) {
                    ef_fz_level ++;
                  }
                }
                else if (ef_cursorLoc == 5) {
                  if(ef_fz_tone < 10) {
                    ef_fz_tone ++;
                  }
                }
              }
              break;
            
            case chorusSettings:
              if (ef_cursorLoc == 2) {
                if(ef_chorus_depth < 10) {
                  ef_chorus_depth ++;
                }
              }
              else if (ef_cursorLoc == 3) {
                if(ef_chorus_rate < 10) {
                  ef_chorus_rate ++;
                }
              }
              else if (ef_cursorLoc == 4) {
                if(ef_chorus_mix < 10) {
                  ef_chorus_mix ++;
                }
              }
              break;

            case delaySettings:
              if (ef_cursorLoc == 2) {
                if (ef_delay_time <= 1.49) {
                  ef_delay_time += 0.03;
                }
              }
              else if (ef_cursorLoc == 3) {
                if (ef_delay_feedback < 9) {
                  ef_delay_feedback ++;
                }
              }
              else if (ef_cursorLoc == 4) {
                if (ef_delay_level < 10) {
                  ef_delay_level ++;
                }
              }
              break;
            case reverbSettings:
              if(ef_cursorLoc == 2) {
                if  (ef_reverb_roomSize < 10) {
                  ef_reverb_roomSize ++;
                }
              }
              else if(ef_cursorLoc == 3) {
                if  (ef_reverb_damping < 10) {
                  ef_reverb_damping ++;
                }
              }
              else if(ef_cursorLoc == 4) {
                if  (ef_reverb_wetDry < 10) {
                  ef_reverb_wetDry ++;
                }
              }
              break;

            default: break;
          }
        }

        // Browsing menu
        else {
          if(ef_cursorLoc < ef_maxCursorLoc) {
            ef_cursorLoc ++;
          }
        }
      }

      // Left
      else if (encoder == -1) {
        // Changing effect values
        if (ef_valueSelected) {
          switch(ef_currentPage) {

            case compressorSettings:
              if(ef_cursorLoc == 2) {
                if(ef_compressor_level > 0) {
                  ef_compressor_level --;
                }
              }
              else if(ef_cursorLoc == 3) {
                if(ef_compressor_threshold > 0) {
                  ef_compressor_threshold --;
                }
              }
              else if(ef_cursorLoc == 4) {
                if(ef_compressor_release > 0) {
                  ef_compressor_release --;
                }
              }
              break;

            case driveSettings:
              // OD
              if(ef_drive_mode == 0) {
                if (ef_cursorLoc == 3) {
                  if(ef_od_drive > 0) {
                    ef_od_drive --;
                  }
                }
                else if (ef_cursorLoc == 4) {
                  if(ef_od_level > 0) {
                    ef_od_level --;
                  }
                }
                else if (ef_cursorLoc == 5) {
                  if(ef_od_tone > 0) {
                    ef_od_tone --;
                  }
                }
              }

              // DS
              else if (ef_drive_mode == 1) {
                if (ef_cursorLoc == 2) {
                  ef_drive_mode = 0;
                }
                else if (ef_cursorLoc == 3) {
                  if(ef_ds_drive > 0) {
                    ef_ds_drive --;
                  }
                }
                else if (ef_cursorLoc == 4) {
                  if(ef_ds_level > 0) {
                    ef_ds_level --;
                  }
                }
                else if (ef_cursorLoc == 5) {
                  if(ef_ds_tone > 0) {
                    ef_ds_tone --;
                  }
                }
              }
              
              // FZ
              else if (ef_drive_mode == 2) {
                if (ef_cursorLoc == 2) {
                  ef_drive_mode = 1;
                }
                else if (ef_cursorLoc == 3) {
                  if(ef_fz_drive > 0) {
                    ef_fz_drive --;
                  }
                }
                else if (ef_cursorLoc == 4) {
                  if(ef_fz_level > 0) {
                    ef_fz_level --;
                  }
                }
                else if (ef_cursorLoc == 5) {
                  if(ef_fz_tone > 0) {
                    ef_fz_tone --;
                  }
                }
              }
              break;

            case chorusSettings:
              if (ef_cursorLoc == 2) {
                if(ef_chorus_depth > 0) {
                  ef_chorus_depth --;
                }
              }
              else if (ef_cursorLoc == 3) {
                if(ef_chorus_rate > 0) {
                  ef_chorus_rate --;
                }
              }
              else if (ef_cursorLoc == 4) {
                if(ef_chorus_mix > 0) {
                  ef_chorus_mix --;
                }
              }
              break;

            case delaySettings:
              if(ef_cursorLoc == 2) {
                if  (ef_delay_time >= 0.01) {
                  ef_delay_time -= 0.03;
                }
              }
              else if(ef_cursorLoc == 3) {
                if  (ef_delay_feedback > 0) {
                  ef_delay_feedback --;
                }
              }
              else if(ef_cursorLoc == 4) {
                if  (ef_delay_level > 0) {
                  ef_delay_level --;
                }
              }
              break;
            case reverbSettings:
              if(ef_cursorLoc == 2) {
                if  (ef_reverb_roomSize > 0) {
                  ef_reverb_roomSize --;
                }
              }
              else if(ef_cursorLoc == 3) {
                if  (ef_reverb_damping > 0) {
                  ef_reverb_damping --;
                }
              }
              else if(ef_cursorLoc == 4) {
                if  (ef_reverb_wetDry > 0) {
                  ef_reverb_wetDry --;
                }
              }
              break;

            default: break;
          }
        }

        // Browsing menu
        else {
          if(ef_cursorLoc > 0) {
            ef_cursorLoc --;
          }
        }
      }
      
      // Draw menus with new cursor value
      switch(ef_currentPage) {
        case typeMenu:
          ef_drawTypeMenu();
          break;

          case dynamic:
            ef_drawDynamic();
            break;
            
            case compressorSettings:
              ef_drawCompressor();
              break;

          case driveSettings:
            ef_drawDrive();
            break;
          
          case modulation:
            ef_drawModulation();
            break;

            case chorusSettings:
            ef_drawChorus();
            break;

          case timeBased:
            ef_drawTimeBased();
            break;

            case delaySettings:
              ef_drawDelay();
              break;

            case reverbSettings:
              ef_drawReverb();
              break;

        default:
          break;
      }
      display.display();
    }
  }
}

void ef_drawTypeMenu() {
  ef_maxCursorLoc = 6;

  display.fillScreen(BLACK);
  display.setTextSize(2);
  display.setTextColor(WHITE, BLACK);
  display.setCursor(0, 0);
  display.println("<<< Preset: " + String(ef_presetNum));
  if(ef_cursorLoc < 6) {
    display.println("Dynamic");
    display.println("Pitch");
    display.println("Drive");
    display.println("Modulation");
  }
  else {
    display.println("Time-Based");
  }

  display.setTextColor(BLUE);
  switch(ef_cursorLoc) {
    case 0:
      display.setCursor(0, 0);
      display.print("<<<");
      break;
    case 1:
      display.setCursor(48, 0);
      display.print("Preset: " + String(ef_presetNum));
      break;
    case 2:
      display.setCursor(0, 16);
      display.print("Dynamic");
      break;
    case 3:
      display.setCursor(0, 32);
      display.print("Pitch");
      break;
    case 4:
      display.setCursor(0, 48);
      display.print("Drive");
      break;
    case 5:
      display.setCursor(0, 64);
      display.print("Modulation");
      break;
    case 6:
      display.setCursor(0, 16);
      display.print("Time-Based");
      break;
  }
}

void ef_drawDynamic() {
  ef_maxCursorLoc = 3;

  display.fillScreen(BLACK);
  display.setTextSize(2);
  display.setTextColor(WHITE, BLACK);
  display.setCursor(0, 0);
  display.println("<<< Dynamic");
  display.println("Compressor");
  display.println("Wah Wah");
  display.println("EQ");

  display.setTextColor(BLUE);
  switch(ef_cursorLoc) {
    case 0:
      display.setCursor(0, 0);
      display.print("<<<");
      break;
    case 1:
      display.setCursor(0, 16);
      display.print("Compressor");
      break;
    case 2:
      display.setCursor(0, 32);
      display.print("Wah Wah");
      break;
    case 3:
      display.setCursor(0, 48);
      display.print("EQ");
      break;
  }
}

void ef_drawCompressor() {
  ef_maxCursorLoc = 4;

  display.fillScreen(BLACK);
  display.setTextSize(2);
  display.setTextColor(WHITE);
  display.setCursor(0, 0);
  display.print("<<<");
  // Compressor on/off
  if (ef_compressor_on) {
    // Enable compressor and apply settings
    compressorLevelAmp.gain(1 + float(ef_compressor_level) / 10);
    //ef_compressor_maxRelease = 1000 * (float(ef_compressor_release) / 10); // Change the hardcoded value if adjustment is needed
    display.setTextColor(GREEN);
  }
  else {
    // Disable compressor
    compressorAmp.gain(1);
    compressorLevelAmp.gain(1);
    display.setTextColor(GRAY);
  }

  display.println("Compressor");
  display.setTextColor(WHITE);

  // Parameters
  display.println("Level      " + String(ef_compressor_level));
  display.println("Threshold  " + String(ef_compressor_threshold));
  display.println("Release    " + String(ef_compressor_release));

  // Cursor on parameter value
  display.setTextColor(BLUE);
  if (ef_valueSelected) {
    switch(ef_cursorLoc) {
      case 2:
        display.setCursor(132, 16);
        display.print(String(ef_compressor_level));
        break;
      case 3:
        display.setCursor(132, 32);
        display.print(ef_compressor_threshold);
        break;
      case 4:
        display.setCursor(132, 48);
        display.print(ef_compressor_release);
        break;
    }
  }
  // Cursor on parameter name
  else {
    switch(ef_cursorLoc) {
      case 0:
        display.setCursor(0, 0);
        display.print("<<<");
        break;
      case 1:
        if (ef_compressor_on) {
          display.setTextColor(GREEN, WHITE);
        }
        else {
          display.setTextColor(GRAY, WHITE);
        }
        display.setCursor(36, 0);
        display.print("Compressor");
        break;
      case 2:
        display.setCursor(0, 16);
        display.print("Level");
        break;
      case 3:
        display.setCursor(0, 32);
        display.print("Threshold");
        break;
      case 4:
        display.setCursor(0, 48);
        display.print("Release");
        break;
    }
  }
}

void ef_drawDrive() {
  ef_maxCursorLoc = 5;
  display.fillScreen(BLACK);
  display.setTextSize(2);
  display.setTextColor(WHITE);
  display.setCursor(0, 0);
  display.print("<<< ");

  int drive = 0;
  int level = 0;
  int tone = 0;
  String mode = "";

  // Overdrive
  if(ef_drive_mode == 0) {
    if(ef_drive_on) {
      // Enable OD and apply settings

      overdriveMixer.gain(0, 0);
      overdriveMixer.gain(1, 1);
      overdriveMixer.gain(2, 0);
      generateODShape(ef_od_drive + 5);
      overdriveWaveshape.shape(ef_od_shape, EF_OD_LENGTH);
      overdriveLevelAmp.gain(float(ef_od_level) / 10);
      distortionGainAmp.gain(1);
      distortionLevelAmp.gain(1);
      overdriveBiquad.setLowpass(0, ef_od_tone * 1400 + 1000, 0.3);

      display.setTextColor(GREEN);
    }
    else {
      ef_drive_disable();

      display.setTextColor(GRAY);
    }
    
    mode = "OD";
    drive = ef_od_drive;
    level = ef_od_level;
    tone = ef_od_tone;
  }

  // Distortion
  else if(ef_drive_mode == 1) {
    if(ef_drive_on) {
      // Enable DS and apply settings
      //ef_drive_disable();

      overdriveMixer.gain(0, 0);
      overdriveMixer.gain(1, 1);
      overdriveMixer.gain(2, 0);
      generateODShape(ef_ds_drive + 5);
      overdriveWaveshape.shape(ef_od_shape, EF_OD_LENGTH);
      overdriveLevelAmp.gain(float(ef_ds_level) / 10);
      distortionGainAmp.gain(float(ef_ds_drive) / 2);
      distortionLevelAmp.gain(float(ef_ds_level) / 50);
      overdriveBiquad.setLowpass(0, ef_ds_tone * 1400 + 1000, 0.3);

      display.setTextColor(GREEN);
    }
    else {
      ef_drive_disable();

      display.setTextColor(GRAY);
    }
    
    mode = "DS";
    drive = ef_ds_drive;
    level = ef_ds_level;
    tone = ef_ds_tone;
  }

  // Fuzz
  else if(ef_drive_mode == 2) {
    if(ef_drive_on) {
      // Enable DS and apply settings
      ef_drive_disable();

      overdriveMixer.gain(0, 0);
      overdriveMixer.gain(1, 0);
      overdriveMixer.gain(2, 1);
      

      display.setTextColor(GREEN);
    }
    else {
      ef_drive_disable();

      display.setTextColor(GRAY);
    }
    
    mode = "FZ";
    drive = ef_fz_drive;
    level = ef_fz_level;
    tone = ef_fz_tone;

  }

  display.println("Drive");
  display.setTextColor(WHITE);

  // Parameters
  display.println("Mode       " + mode);
  display.println("Drive      " + String(drive));
  display.println("Level      " + String(level));
  display.println("Tone       " + String(tone));

  // Cursor on parameter value
  display.setTextColor(BLUE);
  if (ef_valueSelected) {
    switch(ef_cursorLoc) {
      case 2:
        display.setCursor(132, 16);
        display.print(mode);
        break;
      case 3:
        display.setCursor(132, 32);
        display.print(drive);
        break;
      case 4:
        display.setCursor(132, 48);
        display.print(level);
        break;
      case 5:
        display.setCursor(132, 64);
        display.print(tone);
        break;
    }
  }
  // Cursor on parameter name
  else {
    switch(ef_cursorLoc) {
      case 0:
        display.setCursor(0, 0);
        display.print("<<<");
        break;
      case 1:
        if (ef_drive_on) {
          display.setTextColor(GREEN, WHITE);
        }
        else {
          display.setTextColor(GRAY, WHITE);
        }
        display.setCursor(48, 0);
        display.print("Drive");
        break;
      case 2:
        display.setCursor(0, 16);
        display.print("Mode");
        break;
      case 3:
        display.setCursor(0, 32);
        display.print("Drive");
        break;
      case 4:
        display.setCursor(0, 48);
        display.print("Level");
        break;
      case 5:
        display.setCursor(0, 64);
        display.print("Tone");
        break;
    }
  }
}

void ef_drive_disable() {
  overdriveMixer.gain(0, 1);
  overdriveMixer.gain(1, 0);
  overdriveMixer.gain(2, 0);
  overdriveLevelAmp.gain(0);
  distortionGainAmp.gain(0);
  distortionLevelAmp.gain(0);
}

void generateODShape(int drive) {
  for (int i = 0; i < EF_OD_LENGTH; i++) {
    float value = sin(((float)i/EF_OD_LENGTH - 0.45) * M_PI);
    ef_od_shape[i] = value;
  }
  for (int i = 0; i < drive; i++) {
    for(int j = 0; j < EF_OD_LENGTH; j++) {
      ef_od_shape[j] = sin(ef_od_shape[j]);
    }
  }
  for (int i  = 0; i < EF_OD_LENGTH; i++) {
    ef_od_shape[i] = ef_od_shape[i] / ef_od_shape[EF_OD_LENGTH - 1];
  }
}

void ef_drawModulation() {
  ef_maxCursorLoc = 3;
  
  display.fillScreen(BLACK);
  display.setTextSize(2);
  display.setTextColor(WHITE, BLACK);
  display.setCursor(0, 0);
  display.println("<<<Modulation");
  display.println("Chorus");
  display.println("Phaser");
  display.println("Flanger");

  display.setTextColor(BLUE);
  switch(ef_cursorLoc) {
    case 0:
      display.setCursor(0, 0);
      display.print("<<<");
      break;
    case 1:
      display.setCursor(0, 16);
      display.print("Chorus");
      break;
    case 2:
      display.setCursor(0, 32);
      display.print("Phaser");
      break;
    case 3:
      display.setCursor(0, 48);
      display.print("Flanger");
  }
}

void ef_drawChorus() {
  ef_maxCursorLoc = 4;

  display.fillScreen(BLACK);
  display.setTextSize(2);
  display.setTextColor(WHITE);
  display.setCursor(0, 0);
  display.print("<<< ");

  // Chorus On/Off
  if (ef_chorus_on) {
    // Enable chorus and apply settings
    int depth = pow(2, ef_chorus_depth) / 2;
    float rate = pow(2, float(ef_chorus_rate)/2) / 8;
    float mix = float(ef_chorus_mix) / 10;
    chorusFlange.voices(512, depth, rate);
    chorusMixer.gain(0, 1 - mix);
    chorusMixer.gain(1, mix);

    display.setTextColor(GREEN);
  }
  else {
    chorusMixer.gain(0, 1);
    chorusMixer.gain(1, 0);

    display.setTextColor(GRAY);
  }

  display.println("Chorus");
  display.setTextColor(WHITE);

  display.println("Depth      " + String(ef_chorus_depth));
  display.println("Rate       " + String(ef_chorus_rate));
  display.println("Mix        " + String(ef_chorus_mix));

  // Cursor on parameter value
  display.setTextColor(BLUE);
  if (ef_valueSelected) {
    switch(ef_cursorLoc) {
      case 2:
        display.setCursor(132, 16);
        display.print(String(ef_chorus_depth));
        break;
      case 3:
        display.setCursor(132, 32);
        display.print(ef_chorus_rate);
        break;
      case 4:
        display.setCursor(132, 48);
        display.print(ef_chorus_mix);
        break;
    }
  }
  // Cursor on parameter name
  else {
    switch(ef_cursorLoc) {
      case 0:
        display.setCursor(0, 0);
        display.print("<<<");
        break;
      case 1:
        if (ef_chorus_on) {
          display.setTextColor(GREEN, WHITE);
        }
        else {
          display.setTextColor(GRAY, WHITE);
        }
        display.setCursor(48, 0);
        display.print("Chorus");
        break;
      case 2:
        display.setCursor(0, 16);
        display.print("Depth");
        break;
      case 3:
        display.setCursor(0, 32);
        display.print("Rate");
        break;
      case 4:
        display.setCursor(0, 48);
        display.print("Mix");
        break;
    }
  }
}


void ef_drawTimeBased() {
  ef_maxCursorLoc = 2;
  
  display.fillScreen(BLACK);
  display.setTextSize(2);
  display.setTextColor(WHITE, BLACK);
  display.setCursor(0, 0);
  display.println("<<<Time-Based");
  display.println("Delay");
  display.println("Reverb");

  display.setTextColor(BLUE);
  switch(ef_cursorLoc) {
    case 0:
      display.setCursor(0, 0);
      display.print("<<<");
      break;
    case 1:
      display.setCursor(0, 16);
      display.print("Delay");
      break;
    case 2:
      display.setCursor(0, 32);
      display.print("Reverb");
      break;
  }
}

void ef_drawDelay() {
  ef_maxCursorLoc = 4;

  display.fillScreen(BLACK);
  display.setTextSize(2);
  display.setTextColor(WHITE);
  display.setCursor(0, 0);
  display.print("<<< ");
  // Delay on/off
  if (ef_delay_on) {
    // Enable delay and apply settings
    delay1.delay(0, ef_delay_time * 1000);
    delayAmp.gain(float(ef_delay_feedback) / 10);
    delayMixer.gain(1, float(ef_delay_level) / 10);

    display.setTextColor(GREEN);
  }
  else {
    // Disable delay
    delayAmp.gain(0);
    delayMixer.gain(1, 0);

    display.setTextColor(GRAY);
  }

  display.println("Delay");
  display.setTextColor(WHITE);

  // Parameters
  display.println("Time(s)  " + String(ef_delay_time));
  display.println("Feedback   " + String(ef_delay_feedback));
  display.println("Level      " + String(ef_delay_level));

  // Cursor on parameter value
  display.setTextColor(BLUE);
  if (ef_valueSelected) {
    switch(ef_cursorLoc) {
      case 2:
        display.setCursor(108, 16);
        display.print(String(ef_delay_time));
        break;
      case 3:
        display.setCursor(132, 32);
        display.print(ef_delay_feedback);
        break;
      case 4:
        display.setCursor(132, 48);
        display.print(ef_delay_level);
        break;
    }
  }
  // Cursor on parameter name
  else {
    switch(ef_cursorLoc) {
      case 0:
        display.setCursor(0, 0);
        display.print("<<<");
        break;
      case 1:
        if (ef_delay_on) {
          display.setTextColor(GREEN, WHITE);
        }
        else {
          display.setTextColor(GRAY, WHITE);
        }
        display.setCursor(48, 0);
        display.print("Delay");
        break;
      case 2:
        display.setCursor(0, 16);
        display.print("Time(s)");
        break;
      case 3:
        display.setCursor(0, 32);
        display.print("Feedback");
        break;
      case 4:
        display.setCursor(0, 48);
        display.print("Level");
        break;
    }
  }
}

void ef_drawReverb() {
  ef_maxCursorLoc = 4;

  display.fillScreen(BLACK);
  display.setTextSize(2);
  display.setTextColor(WHITE);
  display.setCursor(0, 0);
  display.print("<<< ");
  // Reverb on/off
  if(ef_reverb_on) {
    // Enable reverb and apply settings
    freeverb1.roomsize(float(ef_reverb_roomSize) / 10);
    freeverb1.damping(float(ef_reverb_damping) / 10);
    reverbAmp.gain(1);
    reverbMixer.gain(0, float(10 - ef_reverb_wetDry) / 10);
    reverbMixer.gain(1, float(ef_reverb_wetDry) / 10);

    display.setTextColor(GREEN);
  }
  else {
    // Bypass reverb
    reverbAmp.gain(0);
    reverbMixer.gain(0, 1);
    reverbMixer.gain(1, 0);

    display.setTextColor(GRAY);    
  }

  display.println("Reverb");
  display.setTextColor(WHITE);

  // Parameters
  display.println("Room Size  " + String(ef_reverb_roomSize));
  display.println("Damping    " + String(ef_reverb_damping));
  display.println("Wet/Dry    " + String(ef_reverb_wetDry));

  // Cursor on parameter value
  display.setTextColor(BLUE);
  if (ef_valueSelected) {
    switch(ef_cursorLoc) {
      case 2:
        display.setCursor(132, 16);
        display.print(ef_reverb_roomSize);
        break;
      case 3:
        display.setCursor(132, 32);
        display.print(ef_reverb_damping);
        break;
      case 4:
        display.setCursor(132, 48);
        display.print(ef_reverb_wetDry);
        break;
    }
  }
  // Cursor on parameter name
  else {
    switch(ef_cursorLoc) {
      case 0:
        display.setCursor(0, 0);
        display.print("<<<");
        break;
      case 1:
        if (ef_reverb_on) {
          display.setTextColor(GREEN, WHITE);
        }
        else {
          display.setTextColor(GRAY, WHITE);
        }
        display.setCursor(48, 0);
        display.print("Reverb");
        break;
      case 2:
        display.setCursor(0, 16);
        display.print("Room Size");
        break;
      case 3:
        display.setCursor(0, 32);
        display.print("Damping");
        break;
      case 4:
        display.setCursor(0, 48);
        display.print("Wet/Dry");
        break;
    }
  }
}
